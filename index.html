<!DOCTYPE html>
<html lang="id" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üåå DREAM OS v4.1 FINAL ‚Ä¢ SIF Al Fikri General Affairs</title>
    
    <!-- ALL-IN-ONE FIXED CSS -->
    <style>
        :root {
            --primary: #0a0a2a; --secondary: #00d4ff; --accent: #2E7D32;
            --danger: #ff3860; --warning: #FF9800; --purple: #9c27b0;
            --orange: #FF9800; --light: rgba(255,255,255,0.9);
            --card-bg: rgba(255,255,255,0.05); --card-border: rgba(0,212,255,0.3);
        }
        
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background:var(--primary); color:white; min-height:100vh; overflow-x:hidden; }
        
        /* HEADER - SEDERHANA TAPI ELEGAN */
        .header { 
            background: linear-gradient(135deg, #2D5D4B 0%, #1E293B 100%);
            padding: 1.2rem 1rem; 
            text-align: center; 
            border-bottom: 2px solid var(--secondary);
            animation: headerGlow 3s infinite alternate;
        }
        
        @keyframes headerGlow { 
            0% { border-color: #00d4ff } 
            50% { border-color: #2E7D32 } 
            100% { border-color: #9c27b0 } 
        }
        
        .arabic { 
            font-family: 'Amiri', serif;
            font-size: 1.8rem; 
            color: #4CAF50; 
            margin-bottom: 0.5rem; 
            font-weight: 700; 
        }
        
        .shalawat { 
            font-size: 1.1rem; 
            color: var(--warning); 
            margin-bottom: 0.5rem; 
            font-style: italic;
        }
        
        /* NAVIGASI FIXED BOTTOM */
        .nav { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            background: rgba(10,10,42,0.97); 
            display: flex; 
            padding: 0.8rem 0.5rem; 
            backdrop-filter: blur(15px); 
            z-index: 1000;
            border-top: 1px solid rgba(0,212,255,0.2); 
        }
        
        .nav-item { 
            flex: 1; 
            text-align: center; 
            color: rgba(255,255,255,0.6); 
            padding: 0.7rem 0.5rem; 
            font-size: 0.75rem; 
            cursor: pointer; 
            transition: all 0.4s; 
            border-radius: 12px; 
        }
        
        .nav-item.active { 
            color: var(--secondary); 
            background: rgba(0,212,255,0.15); 
            transform: translateY(-8px); 
        }
        
        .nav-icon { 
            display: block; 
            font-size: 1.5rem; 
            margin-bottom: 0.4rem; 
        }
        
        /* CONTENT AREA */
        .content { 
            padding: 1.5rem; 
            padding-bottom: 120px; 
            max-width: 800px; 
            margin: 0 auto; 
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* CARD DESIGN */
        .card { 
            background: var(--card-bg); 
            border-radius: 20px; 
            padding: 1.8rem; 
            margin: 1.5rem 0; 
            border: 1px solid var(--card-border); 
            transition: all 0.4s; 
            position: relative; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .card::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: 0; 
            right: 0; 
            height: 4px;
            background: linear-gradient(90deg, var(--secondary), var(--accent)); 
            border-radius: 20px 20px 0 0;
        }
        
        /* BUTTONS */
        .btn { 
            width: 100%; 
            padding: 1.2rem; 
            background: linear-gradient(135deg, var(--accent), #4CAF50); 
            color: white; 
            border: none; 
            border-radius: 12px; 
            font-size: 1.1rem; 
            font-weight: 700; 
            cursor: pointer; 
            margin-top: 1.5rem; 
            transition: all 0.4s; 
            position: relative; 
            overflow: hidden; 
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        
        /* FORM ELEMENTS */
        .form-group { margin-bottom: 1.5rem; }
        
        .form-label { 
            display: block; 
            margin-bottom: 0.7rem; 
            color: var(--secondary); 
            font-weight: 600; 
            font-size: 0.9rem;
        }
        
        .form-input, .form-select, .form-textarea { 
            width: 100%; 
            padding: 1rem; 
            background: rgba(255,255,255,0.08); 
            border: 2px solid rgba(0,212,255,0.4); 
            border-radius: 10px; 
            color: white; 
            font-size: 1rem; 
            transition: all 0.3s;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none; 
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(0,212,255,0.1);
            background: rgba(255,255,255,0.12);
        }
        
        /* NOTIFICATION */
        .notification { 
            position: fixed; 
            top: 90px; 
            right: 20px; 
            background: var(--accent); 
            color: white; 
            padding: 1.2rem 1.5rem; 
            border-radius: 12px; 
            z-index: 9998; 
            max-width: 350px; 
            animation: slideIn 0.5s; 
            display: flex; 
            align-items: center; 
            gap: 1rem; 
            display: none;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) { 
            .content { padding: 1rem; padding-bottom: 100px; } 
            .card { padding: 1.3rem; }
            .arabic { font-size: 1.5rem; }
        }
        
        @media (max-width: 480px) {
            .nav-item { font-size: 0.7rem; padding: 0.5rem; }
            .nav-icon { font-size: 1.3rem; }
        }
    </style>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- HEADER - TANPA SPLASH SCREEN! -->
    <div class="header">
        <div class="arabic">ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸíŸÖŸê</div>
        <div class="shalawat" id="dynamicShalawat">ÿßŸéŸÑŸÑŸëŸ∞ŸáŸèŸÖŸéŸë ÿµŸéŸÑŸêŸë ÿπŸéŸÑŸéŸâ ÿ≥ŸéŸäŸêŸëÿØŸêŸÜŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç</div>
        <div class="subtitle">üåå DREAM OS v4.1 FINAL ‚Ä¢ <span id="greeting">SIF Al Fikri GA</span></div>
    </div>
    
    <!-- CONTENT AREA -->
    <div id="content" class="content">
        <!-- Default Home Content akan dimuat di sini -->
    </div>
    
    <!-- NAVIGATION -->
    <div class="nav">
        <div class="nav-item active" onclick="showView('home')"><div class="nav-icon">üè†</div><div>Home</div></div>
        <div class="nav-item" onclick="showView('booking')"><div class="nav-icon">üìÖ</div><div>Booking</div></div>
        <div class="nav-item" onclick="showView('k3')"><div class="nav-icon">‚ö†Ô∏è</div><div>K3</div></div>
        <div class="nav-item" onclick="showView('inventory')"><div class="nav-icon">üîß</div><div>Inventory</div></div>
        <div class="nav-item" onclick="showView('admin')"><div class="nav-icon">üîê</div><div>Admin</div></div>
    </div>
    
    <!-- NOTIFICATION -->
    <div id="notification" class="notification"></div>

    <!-- ALL-IN-ONE JAVASCRIPT - TANPA ERROR -->
    <script>
// ==================== DREAM OS v4.1 FINAL ====================
const CONFIG = {
    version: '4.1',
    schoolName: 'SIF Al Fikri',
    contactPerson: 'Pak Erwin',
    contactNumber: '08886183954',
    whatsappNumber: '628886183954'
};

// ==================== COMPLETE DATA ====================
const COMPLETE_DATA = {
    facilities: [
        { id: 'AULA_SMP', name: 'Aula SMP', capacity: 200, equipment: ['sound', 'proyektor', 'kursi', 'meja', 'podium'] },
        { id: 'AULA_SMA', name: 'Aula SMA', capacity: 150, equipment: ['sound', 'proyektor', 'kursi', 'meja', 'ac'] },
        { id: 'SAUNG_BESAR', name: 'Saung Besar', capacity: 100, equipment: ['sound', 'kursi', 'meja'] },
        { id: 'LABKOMP', name: 'Lab Komputer', capacity: 40, equipment: ['komputer', 'proyektor', 'ac', 'wifi'] },
        { id: 'MUSHOLA', name: 'Mushola', capacity: 50, equipment: ['sound', 'karpet', 'ac'] },
        { id: 'LAPANGAN', name: 'Lapangan Utama', capacity: 500, equipment: ['sound', 'tenda', 'kursi'] },
        { id: 'KANTIN', name: 'Kantin', capacity: 80, equipment: ['meja', 'kursi', 'sound'] }
    ],
    
    units: [
        { id: 'TK', name: 'TK Al Fikri' },
        { id: 'SD', name: 'SD Al Fikri' },
        { id: 'SMP', name: 'SMP Al Fikri' },
        { id: 'SMA', name: 'SMA Al Fikri' },
        { id: 'YAYASAN', name: 'Yayasan Al Fikri' }
    ],
    
    equipment: [
        { id: 'sound-system', name: 'Sound System', quantity: 5, available: 3 },
        { id: 'proyektor', name: 'Proyektor', quantity: 8, available: 6 },
        { id: 'mic-wireless', name: 'Mic Wireless', quantity: 12, available: 8 },
        { id: 'kursi-tambahan', name: 'Kursi Tambahan', quantity: 200, available: 150 },
        { id: 'meja-tambahan', name: 'Meja Tambahan', quantity: 50, available: 30 }
    ],
    
    k3Types: [
        { id: 'kerusakan', name: 'üö® Kerusakan', priority: 'high', team: 'Maintenance', color: '#FF9800' },
        { id: 'kebersihan', name: 'üßπ Kebersihan', priority: 'medium', team: 'Cleaning', color: '#00d4ff' },
        { id: 'keselamatan', name: 'üõ°Ô∏è Keselamatan', priority: 'critical', team: 'Security', color: '#ff3860' },
        { id: 'listrik', name: '‚ö° Listrik', priority: 'critical', team: 'Maintenance', color: '#FFD700' }
    ],
    
    k3Locations: [
        'Aula SMP', 'Aula SMA', 'Saung Besar', 'Lab Komputer', 'Mushola', 
        'Lapangan', 'Kantin', 'Toilet', 'Parkiran', 'Taman'
    ]
};

// ==================== APP STATE ====================
let appState = {
    currentView: 'home',
    isAdmin: false,
    adminPassword: 'alfikri2024',
    capturedPhoto: null
};

// ==================== INITIALIZATION ====================
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ DREAM OS v4.1 FINAL Loading...');
    
    // Initialize localStorage jika kosong
    initLocalStorage();
    
    // Show home view
    showView('home');
    
    // Update greeting
    updateGreeting();
    
    // Show welcome notification
    setTimeout(() => {
        showNotification('üåå DREAM OS v4.1 FINAL Ready!', 'success');
    }, 1000);
    
    console.log('‚úÖ DREAM OS v4.1 FINAL Loaded Successfully!');
});

function initLocalStorage() {
    if (!localStorage.getItem('bookings')) {
        localStorage.setItem('bookings', JSON.stringify([]));
    }
    if (!localStorage.getItem('k3_reports')) {
        localStorage.setItem('k3_reports', JSON.stringify([]));
    }
    if (!localStorage.getItem('inventory')) {
        localStorage.setItem('inventory', JSON.stringify(COMPLETE_DATA.equipment));
    }
    if (!localStorage.getItem('users')) {
        localStorage.setItem('users', JSON.stringify([
            { id: 1, name: 'Admin GA', username: 'admin', password: 'admin123', role: 'admin' }
        ]));
    }
}

// ==================== VIEW SYSTEM ====================
function showView(view) {
    appState.currentView = view;
    
    // Update nav active state
    document.querySelectorAll('.nav-item').forEach((item, index) => {
        item.classList.remove('active');
        const views = ['home', 'booking', 'k3', 'inventory', 'admin'];
        if (views[index] === view) item.classList.add('active');
    });
    
    const content = document.getElementById('content');
    
    switch(view) {
        case 'home':
            content.innerHTML = renderHome();
            updateHomeStats();
            break;
        case 'booking':
            content.innerHTML = renderBooking();
            break;
        case 'k3':
            content.innerHTML = renderK3();
            break;
        case 'inventory':
            content.innerHTML = renderInventory();
            loadInventory();
            break;
        case 'admin':
            content.innerHTML = renderAdmin();
            break;
    }
}

// ==================== RENDER FUNCTIONS ====================
function renderHome() {
    const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
    const k3Reports = JSON.parse(localStorage.getItem('k3_reports') || '[]');
    
    return `
        <div class="card">
            <h2 style="color: var(--secondary); margin-bottom: 1.5rem;">
                <span style="font-size: 1.8rem;">üåå</span> Dashboard Utama
            </h2>
            
            <div style="margin-bottom: 2rem; padding: 1.5rem; background: rgba(0,212,255,0.1); border-radius: 15px;">
                <div style="color: var(--secondary); font-size: 1.2rem; font-weight: 600;" id="greetingText"></div>
                <div style="margin-top: 0.5rem; color: rgba(255,255,255,0.8);">
                    Sistem General Affairs SIF Al Fikri
                </div>
            </div>
            
            <!-- Quick Stats -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 2rem;">
                <div class="stat-card" onclick="showView('booking')">
                    <div style="font-size: 2.5rem; color: var(--secondary);">üìÖ</div>
                    <div style="font-size: 2rem; font-weight: 700;">${bookings.length}</div>
                    <div style="font-size: 0.9rem;">Total Bookings</div>
                </div>
                <div class="stat-card" onclick="showView('k3')">
                    <div style="font-size: 2.5rem; color: var(--warning);">‚ö†Ô∏è</div>
                    <div style="font-size: 2rem; font-weight: 700;">${k3Reports.length}</div>
                    <div style="font-size: 0.9rem;">K3 Reports</div>
                </div>
                <div class="stat-card" onclick="showView('inventory')">
                    <div style="font-size: 2.5rem; color: var(--accent);">üîß</div>
                    <div style="font-size: 2rem; font-weight: 700;">${COMPLETE_DATA.equipment.length}</div>
                    <div style="font-size: 0.9rem;">Inventory Items</div>
                </div>
                <div class="stat-card" onclick="showView('admin')">
                    <div style="font-size: 2.5rem; color: var(--purple);">üë•</div>
                    <div style="font-size: 2rem; font-weight: 700;">1</div>
                    <div style="font-size: 0.9rem;">Admin Users</div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div style="margin-bottom: 1.5rem;">
                <h3 style="color: var(--secondary); margin-bottom: 1rem;">Quick Actions</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <button onclick="showView('booking')" class="quick-action-btn" style="border-color: var(--secondary); color: var(--secondary);">
                        üìÖ Buat Booking Baru
                    </button>
                    <button onclick="showView('k3')" class="quick-action-btn" style="border-color: var(--warning); color: var(--warning);">
                        ‚ö†Ô∏è Laporkan Masalah
                    </button>
                </div>
            </div>
            
            <!-- Recent Activity -->
            <div style="margin-top: 1.5rem;">
                <h3 style="color: var(--secondary); margin-bottom: 1rem;">üìã Recent Activity</h3>
                <div style="max-height: 200px; overflow-y: auto;">
                    ${bookings.slice(-3).reverse().map(booking => `
                        <div style="padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div style="font-weight: 600;">${booking.facility}</div>
                            <div style="font-size: 0.8rem; color: rgba(255,255,255,0.7);">
                                ${booking.date} ‚Ä¢ ${booking.startTime} - ${booking.endTime}
                            </div>
                            <div style="font-size: 0.8rem; margin-top: 0.3rem;">
                                <span style="color: ${booking.status === 'approved' ? '#4CAF50' : 
                                                 booking.status === 'rejected' ? '#f44336' : '#FF9800'}">
                                    ${booking.status.toUpperCase()}
                                </span>
                            </div>
                        </div>
                    `).join('')}
                    ${bookings.length === 0 ? `
                        <div style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.5);">
                            Tidak ada activity
                        </div>
                    ` : ''}
                </div>
            </div>
        </div>
        
        <style>
            .stat-card {
                padding: 1.5rem; text-align: center; background: rgba(255,255,255,0.03); 
                border-radius: 15px; border: 1px solid rgba(0,212,255,0.1); cursor: pointer;
                transition: all 0.3s;
            }
            .stat-card:hover {
                transform: translateY(-5px); border-color: var(--secondary);
                box-shadow: 0 5px 15px rgba(0,212,255,0.1);
            }
            .quick-action-btn {
                padding: 1rem; background: rgba(255,255,255,0.05);
                border: 2px solid; border-radius: 10px; cursor: pointer;
                transition: all 0.3s; font-weight: 600;
            }
            .quick-action-btn:hover {
                transform: translateY(-3px); opacity: 0.9;
            }
        </style>
    `;
}

function renderBooking() {
    return `
        <div class="card">
            <div style="display: flex; align-items: center; margin-bottom: 2rem; gap: 1rem;">
                <button onclick="showView('home')" class="back-btn">
                    ‚Üê Kembali
                </button>
                <div style="flex: 1; text-align: center;">
                    <div style="color: var(--secondary); font-weight: 700; font-size: 1.3rem;">üìÖ Smart Booking System</div>
                    <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7);">Kirim langsung ke WhatsApp Pak Erwin</div>
                </div>
            </div>
            
            <form id="bookingForm">
                <div class="form-group">
                    <label class="form-label">üë§ Nama Pemohon *</label>
                    <input type="text" class="form-input" placeholder="Masukkan nama lengkap..." id="bookingName" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üìû No. WhatsApp *</label>
                    <input type="tel" class="form-input" placeholder="08xxxxxxxxxx" id="bookingPhone" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üè´ Unit *</label>
                    <select class="form-select" id="bookingUnit" required>
                        <option value="">Pilih unit...</option>
                        ${COMPLETE_DATA.units.map(unit => `
                            <option value="${unit.id}">${unit.name}</option>
                        `).join('')}
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üèõÔ∏è Sarana yang Dibooking *</label>
                    <select class="form-select" id="bookingFacility" required>
                        <option value="">Pilih sarana...</option>
                        ${COMPLETE_DATA.facilities.map(fac => `
                            <option value="${fac.id}">${fac.name} (Kapasitas: ${fac.capacity} orang)</option>
                        `).join('')}
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üìÖ Tanggal Booking *</label>
                    <input type="date" class="form-input" id="bookingDate" 
                           min="${new Date().toISOString().split('T')[0]}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">‚è∞ Waktu Booking *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.2rem;">
                        <div>
                            <div style="font-size: 0.9rem; color: var(--secondary); margin-bottom: 0.5rem;">Waktu Mulai *</div>
                            <select class="form-select" id="bookingStartTime" required>
                                <option value="">Pilih waktu</option>
                                <option value="07:30">07:30</option>
                                <option value="08:00">08:00</option>
                                <option value="08:30">08:30</option>
                                <option value="09:00">09:00</option>
                                <option value="09:30">09:30</option>
                                <option value="10:00">10:00</option>
                                <option value="10:30">10:30</option>
                                <option value="11:00">11:00</option>
                                <option value="11:30">11:30</option>
                                <option value="12:00">12:00</option>
                                <option value="12:30">12:30</option>
                                <option value="13:00">13:00</option>
                                <option value="13:30">13:30</option>
                                <option value="14:00">14:00</option>
                                <option value="14:30">14:30</option>
                                <option value="15:00">15:00</option>
                            </select>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: var(--secondary); margin-bottom: 0.5rem;">Waktu Selesai *</div>
                            <select class="form-select" id="bookingEndTime" required>
                                <option value="">Pilih waktu</option>
                                <option value="08:00">08:00</option>
                                <option value="08:30">08:30</option>
                                <option value="09:00">09:00</option>
                                <option value="09:30">09:30</option>
                                <option value="10:00">10:00</option>
                                <option value="10:30">10:30</option>
                                <option value="11:00">11:00</option>
                                <option value="11:30">11:30</option>
                                <option value="12:00">12:00</option>
                                <option value="12:30">12:30</option>
                                <option value="13:00">13:00</option>
                                <option value="13:30">13:30</option>
                                <option value="14:00">14:00</option>
                                <option value="14:30">14:30</option>
                                <option value="15:00">15:00</option>
                                <option value="15:30">15:30</option>
                                <option value="16:00">16:00</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üìù Tujuan & Keterangan *</label>
                    <textarea class="form-textarea" id="bookingPurpose" 
                              placeholder="Jelaskan tujuan booking, acara, jumlah peserta, dll..." 
                              rows="4" required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üë• Perkiraan Jumlah Peserta</label>
                    <input type="number" class="form-input" id="bookingParticipants" placeholder="0" min="0">
                </div>
                
                <button type="button" class="btn" onclick="submitBookingForm()">
                    <span style="display: block; font-size: 1.1rem; margin-bottom: 0.3rem;">
                        üöÄ Submit Booking Request
                    </span>
                    <span style="font-size: 0.9rem; opacity: 0.9;">
                        Akan dikirim ke WhatsApp ${CONFIG.contactPerson}
                    </span>
                </button>
            </form>
            
            <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(0,212,255,0.1); border-radius: 10px;">
                <div style="color: var(--secondary); font-weight: 600; margin-bottom: 0.5rem;">üí° Informasi:</div>
                <div style="font-size: 0.9rem;">
                    1. Booking akan diproses dalam 1x24 jam<br>
                    2. Konfirmasi melalui WhatsApp<br>
                    3. Batalkan minimal 1 hari sebelumnya<br>
                    4. Pastikan data yang diisi benar
                </div>
            </div>
        </div>
        
        <style>
            .back-btn {
                background: rgba(0,212,255,0.1); border: 2px solid var(--secondary); 
                color: var(--secondary); padding: 0.7rem 1.2rem; border-radius: 10px; 
                cursor: pointer; font-weight: 600;
            }
            .back-btn:hover {
                background: rgba(0,212,255,0.2);
            }
        </style>
    `;
}

function renderK3() {
    return `
        <div class="card">
            <div style="display: flex; align-items: center; margin-bottom: 2rem; gap: 1rem;">
                <button onclick="showView('home')" class="back-btn">
                    ‚Üê Kembali
                </button>
                <div style="flex: 1; text-align: center;">
                    <div style="color: var(--warning); font-weight: 700; font-size: 1.3rem;">‚ö†Ô∏è K3 Reporting System</div>
                    <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7);">Laporan cepat dengan foto</div>
                </div>
            </div>
            
            <form id="k3Form">
                <div class="form-group">
                    <label class="form-label">üë§ Nama Pelapor *</label>
                    <input type="text" class="form-input" placeholder="Nama lengkap pelapor..." id="k3Name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üìû No. WhatsApp *</label>
                    <input type="tel" class="form-input" placeholder="08xxxxxxxxxx" id="k3Phone" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">‚ö†Ô∏è Jenis Laporan *</label>
                    <select class="form-select" id="k3Type" required>
                        <option value="">Pilih jenis...</option>
                        ${COMPLETE_DATA.k3Types.map(type => `
                            <option value="${type.id}" style="color: ${type.color};">${type.name}</option>
                        `).join('')}
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üìç Lokasi Kejadian *</label>
                    <select class="form-select" id="k3Location" required>
                        <option value="">Pilih lokasi...</option>
                        ${COMPLETE_DATA.k3Locations.map(loc => `
                            <option value="${loc}">${loc}</option>
                        `).join('')}
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üì∏ Foto Bukti (Opsional)</label>
                    <div onclick="openCamera()" 
                         style="width:100%; height:150px; background:rgba(0,0,0,0.2); 
                                border-radius:15px; display:flex; align-items:center; 
                                justify-content:center; cursor:pointer; border: 2px dashed rgba(0,212,255,0.3);">
                        ${appState.capturedPhoto ? 
                            `<img src="${appState.capturedPhoto}" style="width:100%; height:100%; object-fit:cover; border-radius:13px;">` :
                            `<div style="text-align:center; color:rgba(255,255,255,0.5);">
                                <div style="font-size:3rem; color:var(--secondary);">üì∑</div>
                                <p>Klik untuk ambil foto</p>
                            </div>`
                        }
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üìù Deskripsi Lengkap *</label>
                    <textarea class="form-textarea" id="k3Description" 
                              placeholder="Jelaskan secara detail apa yang terjadi, kerusakan, bahaya, dll..." 
                              rows="4" required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üö® Tingkat Urgensi</label>
                    <select class="form-select" id="k3Urgency">
                        <option value="low">Rendah (1-3 hari)</option>
                        <option value="medium" selected>Sedang (24 jam)</option>
                        <option value="high">Tinggi (4 jam)</option>
                        <option value="critical">Kritis (Segera)</option>
                    </select>
                </div>
                
                <button type="button" class="btn" onclick="submitK3Report()" 
                        style="background: linear-gradient(135deg, var(--warning), #FF9800);">
                    <span style="display: block; font-size: 1.1rem; margin-bottom: 0.3rem;">
                        üö® Kirim Laporan K3
                    </span>
                    <span style="font-size: 0.9rem; opacity: 0.9;">
                        Akan dikirim ke WhatsApp Pak Erwin
                    </span>
                </button>
            </form>
            
            <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(255,152,0,0.1); border-radius: 10px;">
                <div style="color: var(--warning); font-weight: 600; margin-bottom: 0.5rem;">üìû Emergency Contact:</div>
                <div style="font-size: 0.9rem;">
                    ‚Ä¢ Pak Erwin: 0888-6183-954<br>
                    ‚Ä¢ Security: 0812-3456-7890<br>
                    ‚Ä¢ Maintenance: 0813-4567-8901
                </div>
            </div>
        </div>
    `;
}

function renderInventory() {
    return `
        <div class="card">
            <div style="display: flex; align-items: center; margin-bottom: 2rem; gap: 1rem;">
                <button onclick="showView('home')" class="back-btn">
                    ‚Üê Kembali
                </button>
                <div style="flex: 1; text-align: center;">
                    <div style="color: var(--accent); font-weight: 700; font-size: 1.3rem;">üîß Inventory Management</div>
                    <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7);">Data peralatan sekolah</div>
                </div>
            </div>
            
            <!-- Inventory List -->
            <div id="inventoryList" style="max-height: 400px; overflow-y: auto; margin-bottom: 1.5rem;">
                Loading inventory...
            </div>
            
            <!-- Statistics -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                <div style="padding: 1rem; background: rgba(0,212,255,0.1); border-radius: 10px; text-align: center;">
                    <div style="font-size: 1.5rem; color: var(--secondary);" id="totalItems">0</div>
                    <div style="font-size: 0.9rem;">Total Items</div>
                </div>
                <div style="padding: 1rem; background: rgba(76,175,80,0.1); border-radius: 10px; text-align: center;">
                    <div style="font-size: 1.5rem; color: #4CAF50;" id="availableItems">0</div>
                    <div style="font-size: 0.9rem;">Available</div>
                </div>
                <div style="padding: 1rem; background: rgba(255,152,0,0.1); border-radius: 10px; text-align: center;">
                    <div style="font-size: 1.5rem; color: var(--warning);" id="inUseItems">0</div>
                    <div style="font-size: 0.9rem;">In Use</div>
                </div>
            </div>
        </div>
    `;
}

function renderAdmin() {
    if (!appState.isAdmin) {
        return `
            <div class="card">
                <div style="display: flex; align-items: center; margin-bottom: 2rem; gap: 1rem;">
                    <button onclick="showView('home')" class="back-btn">
                        ‚Üê Kembali
                    </button>
                    <div style="flex: 1; text-align: center;">
                        <div style="color: var(--purple); font-weight: 700; font-size: 1.3rem;">üîê Admin Login</div>
                        <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7);">Hanya untuk staff berwenang</div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-bottom: 2.5rem;">
                    <div style="width: 100px; height: 100px; background: rgba(0,212,255,0.2); border-radius: 50%; 
                         display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; 
                         font-size: 3rem; color: var(--secondary);">
                        üîê
                    </div>
                    <h3 style="color: var(--secondary); margin-bottom: 0.5rem;">Authentication Required</h3>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üë§ Username</label>
                    <input type="text" class="form-input" placeholder="Masukkan username..." id="adminUsername">
                </div>
                
                <div class="form-group">
                    <label class="form-label">üîë Password</label>
                    <input type="password" class="form-input" placeholder="Masukkan password..." id="adminPassword">
                </div>
                
                <button class="btn" onclick="adminLogin()" 
                        style="background: linear-gradient(135deg, var(--purple), #9c27b0);">
                    üîì Login sebagai Admin
                </button>
                
                <!-- Demo Credentials -->
                <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(255,215,0,0.1); border-radius: 12px;">
                    <div style="font-size: 0.9rem; color: rgba(255,255,255,0.8); text-align: center;">
                        <strong style="color: var(--warning);">Demo Credentials:</strong><br>
                        <div style="margin-top: 1rem;">
                            <div style="background: rgba(0,212,255,0.1); padding: 0.7rem; border-radius: 8px;">
                                <div style="color: var(--secondary); font-weight: 600;">Admin</div>
                                <div style="font-size: 0.8rem;">Username: admin<br>Password: admin123</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    } else {
        return `
            <div class="card">
                <div style="display: flex; align-items: center; margin-bottom: 2rem; gap: 1rem;">
                    <button onclick="showView('home')" class="back-btn">
                        ‚Üê Kembali
                    </button>
                    <div style="flex: 1; text-align: center;">
                        <div style="color: var(--purple); font-weight: 700; font-size: 1.3rem;">üëë Admin Dashboard</div>
                        <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7);">Welcome, Admin!</div>
                    </div>
                </div>
                
                <!-- Admin Menu -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1.2rem; margin-bottom: 2rem;">
                    <button onclick="viewBookings()" class="admin-menu-btn">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìÖ</div>
                        <div>View Bookings</div>
                    </button>
                    <button onclick="viewK3Reports()" class="admin-menu-btn">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚ö†Ô∏è</div>
                        <div>K3 Reports</div>
                    </button>
                    <button onclick="viewInventory()" class="admin-menu-btn">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîß</div>
                        <div>Inventory</div>
                    </button>
                </div>
                
                <!-- Quick Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                    <div style="padding: 1rem; background: rgba(0,212,255,0.1); border-radius: 10px; text-align: center;">
                        <div style="font-size: 1.2rem; color: var(--secondary;" id="adminBookingCount">0</div>
                        <div style="font-size: 0.8rem;">Total Bookings</div>
                    </div>
                    <div style="padding: 1rem; background: rgba(255,152,0,0.1); border-radius: 10px; text-align: center;">
                        <div style="font-size: 1.2rem; color: var(--warning);" id="adminK3Count">0</div>
                        <div style="font-size: 0.8rem;">Open K3</div>
                    </div>
                    <div style="padding: 1rem; background: rgba(76,175,80,0.1); border-radius: 10px; text-align: center;">
                        <div style="font-size: 1.2rem; color: #4CAF50;">${COMPLETE_DATA.equipment.length}</div>
                        <div style="font-size: 0.8rem;">Inventory Items</div>
                    </div>
                </div>
                
                <!-- System Actions -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <button onclick="exportData()" style="padding: 1rem; background: rgba(0,212,255,0.1); 
                           border: 2px solid var(--secondary); color: var(--secondary); border-radius: 10px;">
                        üíæ Export Data
                    </button>
                    <button onclick="logoutAdmin()" style="padding: 1rem; background: rgba(255,86,86,0.1); 
                           border: 2px solid var(--danger); color: var(--danger); border-radius: 10px;">
                        üö™ Logout
                    </button>
                </div>
            </div>
            
            <style>
                .admin-menu-btn {
                    padding: 1.5rem 0.5rem; background: rgba(255,255,255,0.03); 
                    border: 2px solid rgba(0,212,255,0.1); color: white; 
                    border-radius: 15px; cursor: pointer; transition: all 0.3s;
                }
                .admin-menu-btn:hover {
                    transform: translateY(-5px); border-color: var(--purple);
                    background: rgba(156,39,176,0.1);
                }
            </style>
        `;
    }
}

// ==================== UTILITY FUNCTIONS ====================
function updateGreeting() {
    const now = new Date();
    const hour = now.getHours();
    const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
    const day = days[now.getDay()];
    
    let greeting = '';
    if (hour >= 4 && hour < 10) greeting = 'üåÑ Subhanallah, pagi penuh berkah';
    else if (hour >= 10 && hour < 15) greeting = '‚òÄÔ∏è Allahu Akbar, siang yang produktif';
    else if (hour >= 15 && hour < 18) greeting = 'üåÖ Masya Allah, sore penuh kedamaian';
    else greeting = 'üåô Allahumma barik, malam yang penuh hikmah';
    
    const greetingEl = document.getElementById('greeting');
    const greetingTextEl = document.getElementById('greetingText');
    
    if (greetingEl) greetingEl.textContent = `${greeting} ‚Ä¢ ${day}`;
    if (greetingTextEl) greetingTextEl.textContent = `${greeting} ‚Ä¢ ${day}`;
}

function showNotification(message, type = 'info') {
    const notification = document.getElementById('notification');
    if (!notification) return;
    
    const colors = {
        'success': '#4CAF50', 
        'error': '#f44336', 
        'warning': '#FF9800', 
        'info': '#2196f3'
    };
    
    const icons = {
        'success': '‚úÖ', 
        'error': '‚ùå', 
        'warning': '‚ö†Ô∏è', 
        'info': '‚ÑπÔ∏è'
    };
    
    notification.style.background = colors[type] || colors.info;
    notification.innerHTML = `
        <div style="font-size: 1.5rem; color: white;">
            ${icons[type] || '‚ÑπÔ∏è'}
        </div>
        <div style="flex: 1;">${message}</div>
        <button onclick="this.parentElement.style.display='none'" 
                style="background:transparent; border:none; color:white; font-size:1.2rem; cursor:pointer;">
            √ó
        </button>
    `;
    notification.style.display = 'flex';
    
    setTimeout(() => {
        notification.style.display = 'none';
    }, 3000);
}

// ==================== BOOKING FUNCTIONS ====================
function submitBookingForm() {
    const name = document.getElementById('bookingName').value.trim();
    const phone = document.getElementById('bookingPhone').value.trim();
    const unit = document.getElementById('bookingUnit').value;
    const facilityId = document.getElementById('bookingFacility').value;
    const date = document.getElementById('bookingDate').value;
    const startTime = document.getElementById('bookingStartTime').value;
    const endTime = document.getElementById('bookingEndTime').value;
    const purpose = document.getElementById('bookingPurpose').value.trim();
    const participants = document.getElementById('bookingParticipants').value || 0;
    
    // Validation
    if (!name || !phone || !unit || !facilityId || !date || !startTime || !endTime || !purpose) {
        showNotification('Harap isi semua field yang wajib!', 'error');
        return;
    }
    
    // Validate phone
    const phoneRegex = /^[0-9]{10,13}$/;
    if (!phoneRegex.test(phone.replace(/\D/g, ''))) {
        showNotification('Nomor WhatsApp tidak valid', 'error');
        return;
    }
    
    // Get facility name
    const facility = COMPLETE_DATA.facilities.find(f => f.id === facilityId);
    if (!facility) {
        showNotification('Sarana tidak valid', 'error');
        return;
    }
    
    // Create booking object
    const booking = {
        id: 'BOOK-' + Date.now().toString().slice(-8),
        name: name,
        phone: phone,
        unit: unit,
        facility: facility.name,
        date: date,
        startTime: startTime,
        endTime: endTime,
        purpose: purpose,
        participants: parseInt(participants) || 0,
        status: 'pending',
        submittedAt: new Date().toISOString()
    };
    
    // Save to localStorage
    const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
    bookings.push(booking);
    localStorage.setItem('bookings', JSON.stringify(bookings));
    
    // Generate WhatsApp message
    const whatsappMessage = generateBookingWhatsAppMessage(booking, facility);
    
    // Show success
    showNotification('‚úÖ Booking submitted! Siap kirim ke WhatsApp', 'success');
    
    // Open WhatsApp
    setTimeout(() => {
        sendToWhatsApp(whatsappMessage);
    }, 1500);
}

function generateBookingWhatsAppMessage(booking, facility) {
    const unitName = COMPLETE_DATA.units.find(u => u.id === booking.unit)?.name || booking.unit;
    
    return `üìã *BOOKING SARANA - ${CONFIG.schoolName}*

üë§ *Pemohon:* ${booking.name}
üìû *WhatsApp:* ${booking.phone}
üè´ *Unit:* ${unitName}

üèõÔ∏è *Sarana:* ${booking.facility}
üìÖ *Tanggal:* ${booking.date}
‚è∞ *Waktu:* ${booking.startTime} - ${booking.endTime}
üë• *Perkiraan Peserta:* ${booking.participants || 'Tidak disebutkan'}

üìù *Keperluan/Tujuan:*
${booking.purpose}

üìä *Info Sarana:*
‚Ä¢ Kapasitas: ${facility.capacity} orang
‚Ä¢ Equipment: ${facility.equipment.join(', ')}

üÜî *ID Booking:* ${booking.id}
‚è≥ *Diajukan:* ${new Date(booking.submittedAt).toLocaleString('id-ID')}
üìã *Status:* Menunggu konfirmasi

üìû *Konfirmasi ke:* ${CONFIG.contactPerson} (${CONFIG.contactNumber})`;
}

// ==================== K3 FUNCTIONS ====================
function openCamera() {
    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        showNotification('Kamera tidak didukung di perangkat ini', 'warning');
        return;
    }
    
    navigator.mediaDevices.getUserMedia({ video: true })
        .then(function(stream) {
            // Create camera modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.9);
                z-index: 9999;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            `;
            
            const video = document.createElement('video');
            video.style.cssText = `
                width: 90%;
                max-width: 500px;
                border-radius: 10px;
                background: #000;
            `;
            video.autoplay = true;
            video.srcObject = stream;
            
            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = `
                margin-top: 20px;
                display: flex;
                gap: 10px;
            `;
            
            const captureBtn = document.createElement('button');
            captureBtn.textContent = 'üì∏ Capture';
            captureBtn.style.cssText = `
                padding: 15px 30px;
                background: var(--secondary);
                color: var(--primary);
                border: none;
                border-radius: 10px;
                font-size: 1.2rem;
                font-weight: bold;
                cursor: pointer;
            `;
            
            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = '‚úï Cancel';
            cancelBtn.style.cssText = `
                padding: 15px 30px;
                background: rgba(255,255,255,0.1);
                color: white;
                border: 2px solid rgba(255,255,255,0.3);
                border-radius: 10px;
                font-size: 1.2rem;
                cursor: pointer;
            `;
            
            captureBtn.onclick = function() {
                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // Add watermark
                ctx.font = '20px Arial';
                ctx.fillStyle = 'rgba(0, 212, 255, 0.8)';
                ctx.fillText(`${CONFIG.schoolName} - K3 Report`, 20, 40);
                ctx.fillText(new Date().toLocaleDateString('id-ID'), 20, canvas.height - 20);
                
                appState.capturedPhoto = canvas.toDataURL('image/jpeg', 0.8);
                
                // Stop stream
                stream.getTracks().forEach(track => track.stop());
                
                // Remove modal
                document.body.removeChild(modal);
                
                // Update K3 view
                if (appState.currentView === 'k3') {
                    showView('k3');
                }
                
                showNotification('‚úÖ Foto berhasil diambil!', 'success');
            };
            
            cancelBtn.onclick = function() {
                stream.getTracks().forEach(track => track.stop());
                document.body.removeChild(modal);
            };
            
            buttonContainer.appendChild(captureBtn);
            buttonContainer.appendChild(cancelBtn);
            
            modal.appendChild(video);
            modal.appendChild(buttonContainer);
            document.body.appendChild(modal);
        })
        .catch(function(error) {
            console.error('Camera error:', error);
            showNotification('Tidak dapat mengakses kamera', 'error');
        });
}

function submitK3Report() {
    const reporter = document.getElementById('k3Name').value.trim();
    const phone = document.getElementById('k3Phone').value.trim();
    const typeId = document.getElementById('k3Type').value;
    const location = document.getElementById('k3Location').value;
    const description = document.getElementById('k3Description').value.trim();
    const urgency = document.getElementById('k3Urgency').value;
    
    // Validation
    if (!reporter || !phone || !typeId || !location || !description) {
        showNotification('Harap isi semua field yang wajib!', 'error');
        return;
    }
    
    // Validate phone
    const phoneRegex = /^[0-9]{10,13}$/;
    if (!phoneRegex.test(phone.replace(/\D/g, ''))) {
        showNotification('Nomor WhatsApp tidak valid', 'error');
        return;
    }
    
    // Get K3 type
    const k3Type = COMPLETE_DATA.k3Types.find(t => t.id === typeId);
    
    // Create report object
    const report = {
        id: 'K3-' + Date.now().toString().slice(-8),
        reporter: reporter,
        phone: phone,
        type: typeId,
        typeName: k3Type ? k3Type.name : typeId,
        location: location,
        description: description,
        urgency: urgency,
        photo: appState.capturedPhoto,
        status: 'open',
        assignedTo: k3Type ? k3Type.team : 'General',
        submittedAt: new Date().toISOString()
    };
    
    // Save to localStorage
    const reports = JSON.parse(localStorage.getItem('k3_reports') || '[]');
    reports.push(report);
    localStorage.setItem('k3_reports', JSON.stringify(reports));
    
    // Generate WhatsApp message
    const whatsappMessage = generateK3WhatsAppMessage(report);
    
    // Show success
    showNotification('‚úÖ Laporan K3 submitted! Siap kirim ke WhatsApp', 'success');
    
    // Open WhatsApp
    setTimeout(() => {
        sendToWhatsApp(whatsappMessage);
    }, 1500);
    
    // Reset photo
    appState.capturedPhoto = null;
}

function generateK3WhatsAppMessage(report) {
    const urgencyText = {
        'critical': 'üö® KRITIS (SEGERA)',
        'high': 'üî¥ TINGGI (4 jam)',
        'medium': 'üü° SEDANG (24 jam)',
        'low': 'üü¢ RENDAH (1-3 hari)'
    }[report.urgency] || 'üü° SEDANG';
    
    return `‚ö†Ô∏è *LAPORAN K3 - ${CONFIG.schoolName}*

üë§ *Pelapor:* ${report.reporter}
üìû *WhatsApp:* ${report.phone}
üìç *Lokasi:* ${report.location}
üîß *Jenis:* ${report.typeName}
üö® *Urgensi:* ${urgencyText}
üë• *Assigned to:* ${report.assignedTo}

üìù *Deskripsi Masalah:*
${report.description}

${report.photo ? 'üì∏ *Foto bukti terlampir*' : 'üì∑ *Tidak ada foto bukti*'}

üÜî *ID Laporan:* ${report.id}
‚è∞ *Dilaporkan:* ${new Date(report.submittedAt).toLocaleString('id-ID')}
üìã *Status:* ${report.status === 'open' ? 'üü° Open' : '‚úÖ Closed'}

üö® *RESPONSE TIME TARGET:* ${report.urgency === 'critical' ? 'SEGERA (<1 jam)' : 
  report.urgency === 'high' ? '4 jam' : 
  report.urgency === 'medium' ? '24 jam' : '3 hari'}

üìû *Contact:* ${CONFIG.contactPerson} (${CONFIG.contactNumber})`;
}

// ==================== INVENTORY FUNCTIONS ====================
function loadInventory() {
    const inventory = JSON.parse(localStorage.getItem('inventory') || JSON.stringify(COMPLETE_DATA.equipment));
    const inventoryList = document.getElementById('inventoryList');
    
    if (!inventoryList) return;
    
    if (inventory.length === 0) {
        inventoryList.innerHTML = `
            <div style="text-align: center; padding: 3rem; color: rgba(255,255,255,0.5);">
                Tidak ada data inventory
            </div>
        `;
        return;
    }
    
    inventoryList.innerHTML = inventory.map(item => `
        <div style="display: flex; align-items: center; padding: 1rem; 
                    border-bottom: 1px solid rgba(255,255,255,0.1);">
            <div style="margin-right: 1rem; font-size: 1.5rem;">
                ${getInventoryIcon(item.name)}
            </div>
            <div style="flex: 1;">
                <div style="font-weight: 600;">${item.name}</div>
                <div style="font-size: 0.85rem; color: rgba(255,255,255,0.7);">
                    ID: ${item.id}
                </div>
            </div>
            <div style="text-align: right;">
                <div style="font-weight: 600; color: ${item.available > 0 ? '#4CAF50' : '#f44336'}">
                    ${item.available}/${item.quantity}
                </div>
                <div style="font-size: 0.8rem; color: rgba(255,255,255,0.5);">
                    Available
                </div>
            </div>
        </div>
    `).join('');
    
    // Update statistics
    updateInventoryStats(inventory);
}

function getInventoryIcon(name) {
    if (name.includes('Sound')) return 'üîä';
    if (name.includes('Proyektor')) return 'üìΩÔ∏è';
    if (name.includes('Mic')) return 'üé§';
    if (name.includes('Kursi')) return 'ü™ë';
    if (name.includes('Meja')) return 'ü™ë';
    return 'üì¶';
}

function updateInventoryStats(inventory) {
    const totalItems = inventory.length;
    const availableItems = inventory.reduce((sum, item) => sum + item.available, 0);
    const inUseItems = inventory.reduce((sum, item) => sum + (item.quantity - item.available), 0);
    
    document.getElementById('totalItems').textContent = totalItems;
    document.getElementById('availableItems').textContent = availableItems;
    document.getElementById('inUseItems').textContent = inUseItems;
}

// ==================== ADMIN FUNCTIONS ====================
function adminLogin() {
    const username = document.getElementById('adminUsername').value.trim();
    const password = document.getElementById('adminPassword').value.trim();
    
    if (!username || !password) {
        showNotification('Harap isi username dan password', 'warning');
        return;
    }
    
    const users = JSON.parse(localStorage.getItem('users') || '[]');
    const user = users.find(u => u.username === username && u.password === password);
    
    if (user) {
        appState.isAdmin = true;
        showNotification(`‚úÖ Welcome, ${user.name}!`, 'success');
        showView('admin');
    } else {
        showNotification('‚ùå Username atau password salah', 'error');
    }
}

function logoutAdmin() {
    appState.isAdmin = false;
    showNotification('üëã Logged out successfully', 'info');
    showView('admin');
}

function viewBookings() {
    const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
    
    const content = `
        <div class="card">
            <h3 style="color: var(--secondary); margin-bottom: 1rem;">üìÖ All Bookings (${bookings.length})</h3>
            <div style="max-height: 300px; overflow-y: auto;">
                ${bookings.map(booking => `
                    <div style="padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-weight: 600;">${booking.facility}</div>
                        <div style="font-size: 0.85rem; color: rgba(255,255,255,0.7);">
                            ${booking.date} ‚Ä¢ ${booking.startTime} - ${booking.endTime}<br>
                            By: ${booking.name} (${booking.phone})
                        </div>
                        <div style="margin-top: 0.5rem;">
                            <span style="color: ${booking.status === 'pending' ? '#FF9800' : 
                                             booking.status === 'approved' ? '#4CAF50' : '#f44336'}; 
                                   font-size: 0.8rem;">
                                ${booking.status.toUpperCase()}
                            </span>
                        </div>
                    </div>
                `).join('')}
                ${bookings.length === 0 ? `
                    <div style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.5);">
                        No bookings found
                    </div>
                ` : ''}
            </div>
        </div>
    `;
    
    document.getElementById('content').innerHTML = content;
}

function viewK3Reports() {
    const reports = JSON.parse(localStorage.getItem('k3_reports') || '[]');
    
    const content = `
        <div class="card">
            <h3 style="color: var(--warning); margin-bottom: 1rem;">‚ö†Ô∏è K3 Reports (${reports.length})</h3>
            <div style="max-height: 300px; overflow-y: auto;">
                ${reports.map(report => `
                    <div style="padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-weight: 600;">${report.typeName}</div>
                        <div style="font-size: 0.85rem; color: rgba(255,255,255,0.7);">
                            ${report.location} ‚Ä¢ ${new Date(report.submittedAt).toLocaleDateString('id-ID')}<br>
                            By: ${report.reporter} (${report.phone})
                        </div>
                        <div style="margin-top: 0.5rem;">
                            <span style="color: ${report.status === 'open' ? '#f44336' : 
                                             report.status === 'in_progress' ? '#FF9800' : '#4CAF50'}; 
                                   font-size: 0.8rem;">
                                ${report.status.toUpperCase()}
                            </span>
                        </div>
                    </div>
                `).join('')}
                ${reports.length === 0 ? `
                    <div style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.5);">
                        No K3 reports found
                    </div>
                ` : ''}
            </div>
        </div>
    `;
    
    document.getElementById('content').innerHTML = content;
}

function viewInventory() {
    showView('inventory');
}

function exportData() {
    const data = {
        bookings: JSON.parse(localStorage.getItem('bookings') || '[]'),
        k3_reports: JSON.parse(localStorage.getItem('k3_reports') || '[]'),
        inventory: JSON.parse(localStorage.getItem('inventory') || JSON.stringify(COMPLETE_DATA.equipment)),
        users: JSON.parse(localStorage.getItem('users') || '[]'),
        exportDate: new Date().toISOString(),
        version: CONFIG.version
    };
    
    const dataStr = JSON.stringify(data, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
    
    const exportFileDefaultName = `dream-os-backup-${new Date().toISOString().split('T')[0]}.json`;
    
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    linkElement.click();
    
    showNotification('üíæ Data exported successfully!', 'success');
}

// ==================== WHATSAPP FUNCTION ====================
function sendToWhatsApp(message) {
    const whatsappUrl = `https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent(message)}`;
    window.open(whatsappUrl, '_blank');
}

// ==================== UPDATE HOME STATS ====================
function updateHomeStats() {
    if (appState.isAdmin) {
        const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
        const k3Reports = JSON.parse(localStorage.getItem('k3_reports') || '[]');
        
        document.getElementById('adminBookingCount').textContent = bookings.length;
        document.getElementById('adminK3Count').textContent = k3Reports.filter(k => k.status === 'open').length;
    }
}

// ==================== INITIAL UPDATE ====================
setInterval(updateGreeting, 60000); // Update greeting every minute
setTimeout(updateHomeStats, 1000); // Initial stats update

console.log('üåå DREAM OS v4.1 FINAL - Ready to use!');
console.log('üì± Mobile Optimized');
console.log('üíæ LocalStorage Ready');
console.log('üìû WhatsApp Integration Active');
console.log('‚úÖ All systems go!');
    </script>
</body>
</html>
